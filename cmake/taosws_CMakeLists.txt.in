
# taosws-rs
set(TAOSWS_RS_GIT_TAG "main")
ExternalProject_Add(taosws-rs
        GIT_REPOSITORY https://github.com/taosdata/taos-connector-rust.git
        GIT_TAG ${TAOSWS_RS_GIT_TAG}
        SOURCE_DIR "${TD_SOURCE_DIR}/tools/taosws-rs"
        BINARY_DIR ""
        #BUILD_IN_SOURCE TRUE
        CONFIGURE_COMMAND ""
        BUILD_COMMAND ""
        INSTALL_COMMAND ""
        TEST_COMMAND ""
        # Fix: Exit if branch checkout fails
        UPDATE_COMMAND "
                cd ${TD_SOURCE_DIR}/tools/taosws-rs &&
                git checkout -f ${TAOSWS_RS_GIT_TAG}
                if [ $(git rev-parse --abbrev-ref HEAD) != '${TAOSWS_RS_GIT_TAG}' ]; then
                echo 'Failed to switch to branch ${TAOSWS_RS_GIT_TAG} in ${TD_SOURCE_DIR}/tools/taosws-rs';
                exit 1;
                fi
        "
)
